<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
    <title>BDG GAME - Account</title>
    <style>
        body { margin: 0; padding: 0; background-color: #1a1a1a; color: white; font-family: Arial, sans-serif; overflow-x: hidden; }
        .container { width: 100%; max-width: 500px; margin: 0 auto; min-height: 100vh; padding-bottom: 100px; position: relative; }

        /* Golden Header */
        .profile-header { 
            background: linear-gradient(180deg, #f3d078 0%, #d4af37 100%); 
            padding: 45px 20px 65px; 
            border-bottom-left-radius: 40px; 
            border-bottom-right-radius: 40px; 
            color: #3d2a00; 
        }
        .user-info-flex { display: flex; align-items: center; gap: 15px; }
        .avatar { width: 75px; height: 75px; border-radius: 50%; border: 3px solid #fff; object-fit: cover; }
        .user-details h2 { margin: 0; font-size: 18px; font-weight: bold; }
        .uid-box { background: rgba(0,0,0,0.1); padding: 4px 10px; border-radius: 15px; font-size: 12px; margin-top: 5px; display: inline-block; }

        /* Total Balance Card */
        .wallet-card { background: #333; margin: -45px 15px 15px; border-radius: 20px; padding: 25px 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.3); }
        .bal-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .enter-wallet { background: #d4af37; color: #3d2a00; padding: 8px 18px; border-radius: 25px; font-size: 13px; font-weight: bold; cursor: pointer; }
        
        .wallet-sub-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; text-align: center; }
        .sub-icon { width: 40px; margin-bottom: 5px; }

        .action-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 0 15px; margin-top: 20px; }
        .action-card { background: #2a2a2a; padding: 20px; border-radius: 10px; text-align: center; border: 1px solid #333; cursor: pointer; }
        .history-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 15px; }
        .history-card { background: #2a2a2a; padding: 12px; border-radius: 10px; display: flex; align-items: center; gap: 10px; border: 1px solid #333; font-size: 12px; cursor: pointer; }

        .menu-list { background: #222; margin: 10px 15px; border-radius: 15px; overflow: hidden; }
        .menu-item { display: flex; justify-content: space-between; align-items: center; padding: 18px 15px; border-bottom: 1px solid #2a2a2a; color: #aaa; }
        .menu-left { display: flex; align-items: center; gap: 12px; }
        .badge-red { background: #ff4d4d; color: white; border-radius: 50px; padding: 2px 8px; font-size: 10px; }

        /* Logout Button - Photo Style */
        .logout-btn-container { padding: 0 15px; margin-top: 25px; }
        .logout-btn { 
            width: 100%; background: transparent; border: 1px solid #5a4a2a; 
            padding: 14px; border-radius: 50px; color: #d4af37; 
            display: flex; align-items: center; justify-content: center; 
            gap: 12px; font-size: 18px; cursor: pointer;
        }

        /* Bottom Nav - Photo Style */
        .bottom-nav { 
            position: fixed; bottom: 0; width: 100%; max-width: 500px; 
            background: #222222; display: flex; justify-content: space-around; 
            padding: 12px 0; border-top: 1px solid #333; 
        }
        .nav-item { text-align: center; color: #888; text-decoration: none; flex: 1; }
        .nav-item.active { color: #d4af37; }
        .nav-icon { font-size: 22px; display: block; margin-bottom: 4px; }
        .nav-label { font-size: 12px; display: block; }
    </style>
</head>
<body>

    <div class="container">
        <div class="profile-header">
            <div class="user-info-flex">
                <img src="https://via.placeholder.com/100" class="avatar" alt="User">
                <div class="user-details">
                    <h2>MEMBERNNGODMCU <span style="background:#333; color:#f3d078; padding:2px 8px; border-radius:10px; font-size:10px;">‚≠ê VIP2</span></h2>
                    <div class="uid-box">UID | <span id="acc_uid">18594327</span> üìã</div>
                    <div style="font-size:11px; margin-top:5px; opacity:0.9;">Last login: 2026-01-21 17:08:51</div>
                </div>
            </div>
        </div>

        <div class="wallet-card">
            <div class="bal-row">
                <div>
                    <div style="font-size:13px; color:#aaa;">Total balance</div>
                    <div style="font-size:24px; font-weight:bold;">‚Çπ<span id="acc_bal">0.00</span> <span style="cursor:pointer;" onclick="syncBalance()">üîÑ</span></div>
                </div>
                <div class="enter-wallet">Enter wallet</div>
            </div>
            <div class="wallet-sub-grid">
                <div>
                    <img src="https://cdn-icons-png.flaticon.com/512/10384/10384160.png" class="sub-icon" alt="wallet">
                    <div style="font-size:14px; color:#888;">ARWallet</div>
                </div>
                <div>
                    <img src="https://cdn-icons-png.flaticon.com/512/1041/1041888.png" class="sub-icon" alt="vip">
                    <div style="font-size:14px; color:#888;">VIP</div>
                </div>
            </div>
        </div>

        <div class="action-grid">
            <div class="action-card" onclick="window.location.href='deposit.html'">
                <img src="https://cdn-icons-png.flaticon.com/512/2489/2489756.png" width="35" alt="dep">
                <div style="margin-top:8px; color:#aaa;">Deposit</div>
            </div>
            <div class="action-card" onclick="window.location.href='withdraw.html'">
                <img src="https://cdn-icons-png.flaticon.com/512/9361/9361198.png" width="35" alt="with">
                <div style="margin-top:8px; color:#aaa;">Withdraw</div>
            </div>
        </div>

        <div class="history-grid">
            <div class="history-card" onclick="window.location.href='deposit-history.html'">
                <span style="font-size:24px;">üìï</span>
                <div>Deposit<br><span style="color:#666; font-size:10px;">My deposit history</span></div>
            </div>
            <div class="history-card" onclick="window.location.href='withdraw-history.html'">
                <span style="font-size:24px;">üìô</span>
                <div>Withdraw<br><span style="color:#666; font-size:10px;">My withdraw history</span></div>
            </div>
        </div>

        <div class="menu-list">
            <div class="menu-item"><div class="menu-left"><span>‚úâÔ∏è</span> Notification</div><div><span class="badge-red">28</span> ‚ùØ</div></div>
            <div class="menu-item"><div class="menu-left"><span>üéÅ</span> Gifts</div><span>‚ùØ</span></div>
            <div class="menu-item"><div class="menu-left"><span>üìä</span> Game statistics</div><span>‚ùØ</span></div>
            <div class="menu-item"><div class="menu-left"><span>üåê</span> Language</div><div style="font-size:13px;">English ‚ùØ</div></div>
        </div>

        <div class="logout-btn-container">
            <button class="logout-btn" onclick="logoutUser()">
                <span style="font-size: 22px;">‚èª</span> Log out
            </button>
        </div>

        <div class="bottom-nav">
            <a href="index.html" class="nav-item">
                <span class="nav-icon">üè†</span>
                <span class="nav-label">Home</span>
            </a>
            <a href="activity.html" class="nav-item">
                <span class="nav-icon">üëú</span>
                <span class="nav-label">Activity</span>
            </a>
            <a href="promotion.html" class="nav-item">
                <span class="nav-icon">üí∞</span>
                <span class="nav-label">Promotion</span>
            </a>
            <a href="account.html" class="nav-item active">
                <span class="nav-icon">üë§</span>
                <span class="nav-label">Account</span>
            </a>
        </div>
    </div>

    <script>
        // --- REAL-TIME DATABASE SYNC ---
        async function syncOriginalBalance() {
            const userPhone = localStorage.getItem('userPhone');
            if (!userPhone) {
                window.location.href = 'login.html';
                return;
            }

            try {
                // Update UID visually
                document.getElementById('acc_uid').innerText = userPhone;

                // Fetch fresh balance from api/user.js
                const response = await fetch(`/api/user?phone=${userPhone}`);
                const data = await response.json();

                if (data.success) {
                    document.getElementById('acc_bal').innerText = data.balance.toFixed(2);
                }
            } catch (err) {
                console.error("Database sync error:", err);
            }
        }

        // Manual refresh icon click
        function syncBalance() {
            syncOriginalBalance();
        }

        function logoutUser() {
            if(confirm("Do you want to logout?")) {
                localStorage.clear();
                window.location.href = 'login.html';
            }
        }

        window.onload = () => {
            syncOriginalBalance();
            // Auto-refresh balance every 10 seconds
            setInterval(syncOriginalBalance, 10000);
        };
    </script>
</body>
</html>
